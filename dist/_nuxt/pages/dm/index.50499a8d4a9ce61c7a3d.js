webpackJsonp([7],{"C+D1":function(t,e,s){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}e.a={middleware:"storage",head:{style:[{cssText:"@media print{@page {size: landscape}}",type:"text/css"}]},data:function(){return{selectedMode:0,selectedType:this.$store.state.streets.length?1:0,description:"",name:"",street:"",scrollBottom:!1,house:"",fastInput:"1 12к1 64",reason:"",list:[],pdfMaking:!1}},methods:{addToList:function(){this.list.push({name:this.name,address:this.address,reason:this.reason}),setTimeout(function(){this.selectedType&&(this.fastInput=""),this.name="",this.house="",this.reason=""}.bind(this),100),this.returnFocus(),this.scrollBottom=!0},deleteFromList:function(t){this.list.splice(t,1)},returnFocus:function(){this.selectedMode?this.$refs[this.selectedType?"fastInputNameForm":"simpleInputNameForm"].$el.focus():this.$refs[this.selectedType?"fastInputForm":"simpleInputForm"].$el.focus()},savePdf:function(){var t,e=this;this.pdfMaking=!0;var s={pageOrientation:"landscape",pageSize:"A4",content:[{text:"Упаковочный лист ДМ",style:"header"}],styles:{header:{fontSize:22,bold:!0,alignment:"center"}},pageMargins:[10,5,10,0]};this.description&&s.content.push({text:this.description,alignment:"center",bold:!0}),s.content.push({table:{headerRows:1,widths:[].concat(n(Array(3+this.selectedMode))).map(function(t){return"*"}),body:[[{text:"П/н",bold:!0}].concat(n(this.selectedMode?[{text:"ФИО",bold:!0},{text:"Адрес",bold:!0}]:[{text:"Адрес",bold:!0}]),[{text:"Причина недоставки",bold:!0}])]}}),(t=s.content[s.content.length-1].table.body).push.apply(t,n(this.list.map(function(t,s){return[s+1].concat(n(e.selectedMode?[t.name,t.address]:[t.address]),[t.reason])}))),pdfMake.createPdf(s).download("dmlist.pdf",function(){return e.pdfMaking=!1})}},computed:{parsedFastInput:function(){var t=this.fastInput.split(" "),e="";return t[0]&&this.$store.state.streets[parseInt(t[0]-1,10)]?e+=this.$store.state.streets[parseInt(t[0]-1,10)]:e+=t[0],t[1]&&(e+=" дом "+t[1]),t[2]&&(e+=" кв. "+t[2]),e},address:function(){return this.selectedType?this.parsedFastInput:this.street+" "+this.house}},updated:function(){this.scrollBottom&&this.$refs.scrollableDiv&&(this.$refs.scrollableDiv.scrollTop=this.$refs.scrollableDiv.scrollHeight,this.scrollBottom=!1)}}},Zdsl:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("C+D1"),a=s("nFV2"),r=s("VU/8")(n.a,a.a,!1,null,null,null);r.options.__file="pages/dm/index.vue",e.default=r.exports},nFV2:function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("div",{staticClass:"card text-center"},[s("div",{staticClass:"card-body"},[s("h5",[t._v("Ввод данных о рассылке")]),s("div",[s("b-form-radio-group",{attrs:{buttons:"","button-variant":"outline-primary",options:[{text:"Без ФИО",value:0},{text:"С ФИО",value:1}]},model:{value:t.selectedMode,callback:function(e){t.selectedMode=e},expression:"selectedMode"}})],1),s("b-form-textarea",{staticClass:"mt-2",attrs:{placeholder:"Описание рассылки: №, отправитель, ШИ",rows:1,"max-rows":6},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),s("h5",{staticClass:"mt-2"},[t._v("Ввод получателей")]),t.$store.state.streets.length?t._e():s("b-alert",{staticClass:"mt-2",attrs:{show:"",variant:"warning"}},[t._v("Заполните список улиц в обслуживании ОПС в\n          "),s("nuxt-link",{attrs:{to:"/settings"}},[t._v("настройках")]),t._v(" чтобы использовать ускоренный ввод\n        ")],1),s("b-card",{attrs:{"no-body":""}},[s("b-tabs",{attrs:{pills:"",card:""},model:{value:t.selectedType,callback:function(e){t.selectedType=e},expression:"selectedType"}},[s("b-tab",{attrs:{title:"Обычный ввод"}},[t.selectedMode?s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"&nbsp;ФИО&nbsp;"}},[s("b-form-input",{ref:"simpleInputNameForm",attrs:{placeholder:"ФИО получателя"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1):t._e(),s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Улица"}},[s("b-form-input",{attrs:{placeholder:"Введите название улицы"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.street,callback:function(e){t.street=e},expression:"street"}}),s("b-dropdown",{attrs:{slot:"append",disabled:!t.$store.state.streets.length,text:"Dropdown",variant:"success"},slot:"append"},[s("i",{staticClass:"fa fa-fw fa-save",attrs:{slot:"button-content"},slot:"button-content"}),t._l(t.$store.state.streets,function(e,n){return s("b-dropdown-item",{key:n+"streetsDropdown",on:{click:function(s){t.street=e}}},[t._v(t._s(e))])})],2)],1),s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"№ дома, кв"}},[s("b-form-input",{ref:"simpleInputForm",attrs:{placeholder:"Номер дома, корпус, квартира"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.house,callback:function(e){t.house=e},expression:"house"}})],1),s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Причина"}},[s("b-form-input",{attrs:{placeholder:"Причина недоставки получателю"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1),s("div",{staticClass:"text-center mt-2"},[s("button",{staticClass:"btn btn-success w-100",on:{click:function(e){t.addToList()}}},[t._v("Добавить в список\n                  "),s("i",{staticClass:"fa fa-fw fa-plus-circle"})])])],1),s("b-tab",{attrs:{disabled:!t.$store.state.streets.length,title:"Ускоренный ввод"}},[t.selectedMode?s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"ФИО"}},[s("b-form-input",{ref:"fastInputNameForm",attrs:{placeholder:"ФИО получателя"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1):t._e(),t.$store.state.streets.length?s("div",{staticClass:"streets-list mt-2"},[s("ul",{staticClass:"list-group text-left"},t._l(t.$store.state.streets,function(e,n){return s("li",{key:n+"streetList",staticClass:"list-group-item p-1 pl-2"},[t._v("№"+t._s(n+1)+": "+t._s(e))])}))]):t._e(),s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Ввод"}},[s("b-input-group-text",{attrs:{slot:"append"},slot:"append"},[s("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"fa fa-fw fa-question-circle-o pointer",attrs:{title:"Ускоренный ввод адреса позволяет сформировать полный адрес, введя только последовательность символов. Символы вводятся через пробел, первым символом должен быть номер улицы, затем через пробел номер дома с корпусом слитно, затем через пробел номер кввартиры. Список улиц должен быть предварительно внесен в настройках программы."}})]),s("b-form-input",{ref:"fastInputForm",attrs:{placeholder:"Через пробел введите № улицы, № дома, № квартиры"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.fastInput,callback:function(e){t.fastInput=e},expression:"fastInput"}})],1),s("b-input-group",{staticClass:"mt-2"},[s("b-form-input",{attrs:{value:t.address,disabled:!0,placeholder:"Ускоренный ввод"}})],1),s("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Причина"}},[s("b-form-input",{attrs:{placeholder:"Причина недоставки получателю"},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addToList(e):null}},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1),s("div",{staticClass:"text-center mt-2"},[s("button",{staticClass:"btn btn-success w-100",on:{click:function(e){t.addToList()}}},[t._v("Добавить в список\n                  "),s("i",{staticClass:"fa fa-fw fa-plus-circle"})])])],1)],1)],1),s("div",{staticClass:"text-center mt-2 btn-group"},[t._m(0),s("button",{staticClass:"btn btn-primary",class:{disabled:t.pdfMaking},on:{click:function(e){t.savePdf()}}},[t._v("Сохранить документ\n            "),t.pdfMaking?t._e():s("i",{staticClass:"fa fa-fw fa-file-pdf-o"}),t.pdfMaking?s("i",{staticClass:"fa fa-fw fa-spin fa-cog"}):t._e()])])],1)])]),s("div",{ref:"dmPrintRef",staticClass:"col-7 dm-print"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"text-center"},[s("h5",{attrs:{contenteditable:"true"}},[t._v("Упаковочный лист ДМ")]),s("p",[t._v(t._s(t.description))]),s("div",{ref:"scrollableDiv",staticClass:"scrollable"},[s("table",{staticClass:"table table-striped"},[s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v("#")]),t.selectedMode?s("th",{attrs:{scope:"col"}},[t._v("ФИО")]):t._e(),s("th",{attrs:{scope:"col"}},[t._v("Адрес")]),s("th",{attrs:{scope:"col"}},[t._v("Причина недоставки")]),s("th",{staticClass:"control",attrs:{scope:"col"}},[s("button",{staticClass:"btn btn-sm btn-danger",class:{disabled:!t.list.length},attrs:{title:"Очистить список"},on:{click:function(e){t.list=[]}}},[s("i",{staticClass:"fa fa-fw fa-trash"})])])])]),s("tbody",t._l(t.list,function(e,n){return s("tr",{key:n+"dmList"},[s("th",{attrs:{scope:"row"}},[t._v(t._s(n+1))]),t.selectedMode?s("td",{attrs:{contenteditable:"true"}},[t._v(t._s(e.name))]):t._e(),s("td",{attrs:{contenteditable:"true"}},[t._v(t._s(e.address))]),s("td",{attrs:{contenteditable:"true"}},[t._v(t._s(e.reason))]),s("td",{staticClass:"control"},[s("button",{staticClass:"btn text-white btn-sm btn-warning",attrs:{title:"Удалить из списка"},on:{click:function(e){t.deleteFromList(n)}}},[s("i",{staticClass:"fa fa-fw fa-minus-circle"})])])])}))])])])])])])])};n._withStripped=!0;var a={render:n,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-success",attrs:{onclick:"window.print()"}},[this._v("Печать листа\n            "),e("i",{staticClass:"fa fa-fw fa-print"})])}]};e.a=a}});